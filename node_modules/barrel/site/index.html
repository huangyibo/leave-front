<html>
  <head>
    <title>Barrel: A JavaScript Player for Time-Based Event Sequences</title>
    <link href='http://fonts.googleapis.com/css?family=UnifrakturCook:700|UnifrakturMaguntia' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="prism.css" type="text/css" charset="utf-8">
    
  </head>
  <body>
    <div id="background">
      <img src="flowers1.png">
    </div>
    <div id="foreground">
      <div id="title">
        <h1>Barrel</h1>
        <h2>Time-based sequences in JavaScript</h2>
      </div>
      <p>The straightforward way to do time-based things in JavaScript is to use the built-in <a href="https://developer.mozilla.org/en-US/Add-ons/Code_snippets/Timers"><code>setTimeout</code></a> function, which takes your function and calls it later.</p>

      <code class="language-javascript">
    var doSomething = function(){
      document.write("Doing something")
    };
    var milliseconds = 1000;
    setTimeout(doSomething, milliseconds);
      </code>

      <p>The idea for this library began by rearranging those pieces. Consider:</p>

      <code class="language-javascript">
    var doer = function(thing){
      document.write(thing)
    };
    var event = {
      time: 1000,
      data: "Doing something"
    };
      </code>

      <p>In the example above we've split our function into a generic <code>doer</code> and the particulars of what to do. We've also combined those particulars with the desired timing and called that combination an <code>event</code>.</p>

      <p>Because each event only describes the "what" and "when"&mdash;with the "how" being left in the doer&mdash;we can think of having a sequence made up of many events that exists independently of any particular playback mechanism. Imagine a JSON document like this, for instance:</p>

      <code class="language-javascript">
    [
      { "time": 1000, "data": "something" },
      { "time": 2000, "data": "something else" },
      { "time": 4000, "data": "something again" }
    ]
      </code>

      <p>This is where this libary comes in, providing a <a href="/api.html">Player API</a> for arrays of event objects. You initialize a Player with your own doer, load the sequence into it, and hit play:</p>

      <code class="language-javascript">
    var player = new Barrel.Player(doer).load(sequence);
    $('#play').click(function(){ player.play() });
    $('#pause').click(function(){ player.pause() });
      </code>
    
      <iframe src="http://localhost:8000">
      
      </iframe>

      <p>Barrel will accept any array of objects where each element has a <code>time</code>, which is always in milliseconds, and a <code>data</code> attribute, which can be anything you want as long as you write a doer that knows what to do with it. This library is abstract on purpose. The semantics about what an event is and how it should be played are left completely up to you. With some imagination, you can use Barrel to work with timed event sequences of any kind: from dancing hamsters on a webpage to a Node.js-controlled pyrotechnics display.</p>

      <p>Separating things out into a player and a sequence has a few neat side-effects. Barrel doesn't do this for you, but it's relatively straightforward to write an HTML template and some CSS that transforms an event sequence into a visual representation:</p>

      <code class="language-javascript">
    var lightShow = [
      { time:   0, data: "#0FF" },
      { time: 100, data: "#F0F" },
      { time: 500, data: "#FF0" }
    ];
      </code>
    
      <code class="language-markup">
    &lt;!-- html template --&gt;
    &lt;div class=&quot;timeline&quot;&gt;
      {{#each lightShow}}
        &lt;div class=&quot;event&quot; style=&quot;left: {{time}}px; background: {{data}};&quot;&gt;&lt;/div&gt;
      {{/each}}
    &lt;/div&gt;
      </code>
      
      <code class="language-css">
    /* css */
    .timeline {
      width: 500px;
    }
    .event {
    
    }
      </code>
      <iframe src="http://localhost:8000">
      
      </iframe>
  
      <p>Turning this into a fully-functional interactive editor is left as an exercise to the reader. &#9786;</p>

      <p>Barrel has no dependencies and should work in just about any JavaScript environment.</p>
    </div>
    <script src="prism.js"></script>
    <img id="leierkasten" src="http://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Austrian_BarrelOrgan.jpg/1280px-Austrian_BarrelOrgan.jpg">
  </body>
</html>