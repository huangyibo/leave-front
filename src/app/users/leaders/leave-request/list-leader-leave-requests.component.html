<div>
  <div id="leave-modify" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" style="width: 70%;" role="document">
      <div class="modal-content">
        <div class="modal-header" style="background: #3c8dbc">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white">
            <span style="color: white" aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title" style="color: white">更新请假信息</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal" role="form">
            <div class="row" style="border-bottom: dotted #d2d6de 2px">
              <div class="form-group col-md-4  no-new-line " style="padding-left: 13%;">
                <label class="col-md-4 col-lg-4 control-label">
                  姓名:
                </label>
                <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                  <p class="form-control-static ">
                    {{currentUser.real_name}}
                  </p>
                </div>
              </div>
              <div class="col-md-4 form-group no-new-line" style="padding-left: 5%;">
                <label class="col-md-4 col-lg-4 control-label">
                  职务职称:
                </label>
                <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                  <p class="form-control-static ">
                    {{currentUser.major}}
                  </p>
                </div>
              </div>
              <div class="col-md-4 form-group no-new-line" style="padding-right: 0">
                <label class="col-md-5 control-label">
                  所属部门:
                </label>
                <div class="col-md-7">
                  <p class="form-control-static ">
                    {{currentUser.department_name}}
                  </p>
                </div>
              </div>
            </div>

            <div class="row" style="margin-top: 15px">

              <div class="col-md-5 col-md-offset-1">
                <div class="row">

                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      (*)请假时间
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <div class="row">
                        <div class="col-md-10">
                          <input type="date" class="form-control " name="start_date"
                                 [(ngModel)]="editingLeaveRequest.start_date" value="{{editingLeaveRequest.start_date}}"
                                 id="inputLeaveDate" title="起始日期"
                                 placeholder="年-月-日"
                                 required/>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10 text-center">
                          <span class="fa fa-arrow-down text-center"></span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10">
                          <input type="date" class="form-control " name="end_date"
                                 [(ngModel)]="editingLeaveRequest.end_date" value="{{editingLeaveRequest.end_date}}"
                                 title="结束日期" placeholder="年-月-日"
                                 required/>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="inputAddress" class="col-md-4 col-lg-4 control-label">
                      (*)地点
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <div class="row">
                        <div class="col-md-10">
                          <input type="text" class="form-control " name="start_addr" id="inputAddress" title="出发地"
                                 placeholder="出发地" [(ngModel)]="editingLeaveRequest.origin_addr"
                                 required/>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10 text-center">
                          <span class="fa fa-arrow-down text-center"></span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10">
                          <input type="text" class="form-control " name="middle_addr" title="经过" placeholder="经过"
                                 [(ngModel)]="editingLeaveRequest.middle_addr"
                                 required/>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10 text-center">
                          <span class="fa fa-arrow-down text-center"></span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-10">
                          <input type="text" class="form-control " name="dest_addr" title="目的地" placeholder="目的地"
                                 [(ngModel)]="editingLeaveRequest.dest_addr"
                                 required/>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
              <div class="col-md-5" style="border-left: #d2d6de solid 2px;">
                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    交通工具
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <select class="form-control" name="traffic_tool" [(ngModel)]="editingLeaveRequest.traffic_tool"
                            id="inputTraficTool" data-placeholder="请选择交通工具"
                            required>
                      <option value="火车(高铁/动车/普通列车)">火车(高铁/动车/普通列车)</option>
                      <option value="飞机">飞机</option>
                      <option value="长途汽车">长途汽车</option>
                      <option value="公共汽车">公共汽车</option>
                      <option value="地铁">地铁</option>
                      <option value="轮船">轮船</option>
                      <option value="其他">其他</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    经费来源
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <select class="form-control" name="funds_source" [(ngModel)]="editingLeaveRequest.funds_source"
                            id="inputFundSource" data-placeholder="请选择经费来源"
                            required>
                      <option value="科室资助">科室资助</option>
                      <option value="科研经费">科研经费</option>
                      <option value="自筹经费">自筹经费</option>
                      <option value="其他">其他</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    授课任务
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <label class="radio-inline" style="font-size: 16px">
                      <input type="radio" name="teaching" [(ngModel)]="editingLeaveRequest.teaching" [value]="true"
                             required/>有
                    </label>
                    <label class="radio-inline" style="font-size: 16px">
                      <input type="radio" name="teaching" [(ngModel)]="editingLeaveRequest.teaching" [value]="false"
                             required/>无
                    </label>
                  </div>
                </div>

                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    保密电脑
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <label class="radio-inline" style="font-size: 16px">
                      <input type="radio" name="pc" [value]="true" [(ngModel)]="editingLeaveRequest.pc" required/>携带
                    </label>
                    <label class="radio-inline" style="font-size: 16px">
                      <input type="radio" name="pc" [value]="false" [(ngModel)]="editingLeaveRequest.pc" required/>未携带
                    </label>
                  </div>
                </div>

                <div class="form-group has-feedback">
                  <label class="col-md-4 col-lg-4 control-label">
                    (*)请假事由
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <textarea class="form-control" name="reason" rows="3" [(ngModel)]="editingLeaveRequest.reason"
                              id="inputReason" placeholder="请输入100字以内的请假批注"
                              aria-describedby="inputReasonStatus" style="margin-top: 10px;" required>
                    </textarea>
                    <!--<span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>-->
                    <span id="inputReasonStatus" class="sr-only">(success)</span>
                  </div>
                </div>

              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
          <button type="button" class="btn btn-primary" (click)="updateLeave()">确认更新</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->
</div>

<div>
  <div id="leave-detail" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" style="width: 60%;" role="document">
      <div class="modal-content">
        <div class="modal-header" style="background: #3c8dbc">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white">
            <span style="color: white" aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title" style="color: white">请假信息详情</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-5 col-md-offset-1">
              <div class="row">
                <form class="form-horizontal" role="form">
                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      姓名
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <p class="form-control-static ">
                        {{currentUser.real_name}}
                      </p>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      职务职称
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <p class="form-control-static ">
                        {{currentUser.major}}
                      </p>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      所属部门
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <p class="form-control-static ">
                        {{currentUser.department_name}}
                      </p>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      请假时间
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <p class="form-control-static ">
                        {{editingLeaveRequest.start_date}} 至 {{editingLeaveRequest.end_date}}
                      </p>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      地点
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <p class="form-control-static ">
                        <span *ngIf="editingLeaveRequest.origin_addr">{{editingLeaveRequest.origin_addr}}-></span>
                        <span *ngIf="editingLeaveRequest.middle_addr">{{editingLeaveRequest.middle_addr}}-></span>
                        <span *ngIf="editingLeaveRequest.dest_addr">{{editingLeaveRequest.dest_addr}}</span>
                      </p>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="col-md-4 col-lg-4 control-label">
                      通讯联系
                    </label>
                    <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                      <p class="form-control-static ">
                        {{!editingLeaveRequest.phone? '无': editingLeaveRequest.phone}}
                      </p>
                    </div>
                  </div>

                </form>
              </div>
            </div>
            <div class="col-md-5 " style="border-left: #d2d6de solid 2px;padding-left: 2%">
              <form class="form-horizontal" role="form">
                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    交通工具
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static ">
                      {{!editingLeaveRequest.traffic_tool? '无' : editingLeaveRequest.traffic_tool}}
                    </p>
                  </div>
                </div>

                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    经费来源
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static ">
                      {{!editingLeaveRequest.funds_source? '无':editingLeaveRequest.funds_source}}
                    </p>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    授课任务
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static ">
                      {{!editingLeaveRequest.teaching? '无':'有'}}
                    </p>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    保密电脑
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static ">
                      {{!editingLeaveRequest.pc? '未携带':'携带'}}
                    </p>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-4 col-lg-4 control-label">
                    请假事由
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static " style="word-wrap:break-word; word-break:normal;">
                      {{!editingLeaveRequest.reason? '无':editingLeaveRequest.reason}}
                    </p>
                  </div>
                </div>

                <div class="form-group no-new-line">
                  <label class="col-md-4 col-lg-4 control-label">
                    系首长审核
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static no-new-line">
                      <span *ngIf="editingLeaveRequest.top_leader_agree==null" class="label label-warning">待审核</span>
                      <span *ngIf="!(editingLeaveRequest.top_leader_agree == null)">{{editingLeaveRequest.top_leader_name}}--
                           <span *ngIf="editingLeaveRequest.top_leader_agree"
                                 class="review-tag review-passed-tag">通过</span>
                           <span *ngIf="!editingLeaveRequest.top_leader_agree"
                                 class="review-tag review-nopass-tag">未通过</span>
                      </span>
                    </p>
                  </div>
                </div>

                <div class="form-group has-feedback">
                  <label class="col-xs-4 col-sm-4 col-md-4 col-lg-4 control-label">
                    请假批注
                  </label>
                  <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                    <p class="form-control-static ">
                      {{!editingLeaveRequest.top_leader_comment? '无':editingLeaveRequest.top_leader_comment}}
                    </p>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" title="关闭窗口" data-dismiss="modal">关闭</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->
</div>

<toaster-container [toasterconfig]="toasterconfig"></toaster-container>

<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-0 table-responsive">
      <table class="table table-striped table-hover">
        <thead>
        <tr>
          <th>编号</th>
          <th>请假时间</th>
          <th>请假事由</th>
          <th>地点</th>
          <th>申请时间</th>
          <th>系首长审核</th>
          <th>操作</th>
        </tr>
        </thead>
        <tbody *ngIf="leaveRequests">
        <tr
          *ngFor="let leave of leaveRequests | async | paginate: {id: 'server', itemsPerPage: 10, currentPage: currentPage, totalItems: rowCount }">
          <td>{{leave.id}}</td>
          <td>{{leave.start_date}} 至 {{leave.end_date}}</td>
          <td>
            <div class="text-wrap" title="{{leave.reason}}">{{leave.reason}}</div>
          </td>
          <td>
            <span *ngIf="leave.origin_addr">{{leave.origin_addr}}-></span>
            <span *ngIf="leave.middle_addr">{{leave.middle_addr}}-></span>
            <span *ngIf="leave.dest_addr">{{leave.dest_addr}}</span>
          </td>
          <td>
            {{leave.apply_time}}
          </td>
          <td class="no-new-line">
            <span *ngIf="leave.top_leader_agree == null" class="label label-warning">待审核</span>
            <span *ngIf="!(leave.top_leader_agree == null)">
              {{leave.top_leader_name}}--
                <span *ngIf="leave.top_leader_agree" class="label label-success">通过</span>
                <span *ngIf="!leave.top_leader_agree" class="label label-danger">未通过</span>
            </span>
          </td>
          <td class="no-new-line">
            <a (click)="editLeave(leave.id)" class="fa fa-edit disabled" title="编辑"
               [ngClass]="{'hidden': !(leave.top_leader_agree == null)}"
               role="button" data-toggle="modal" data-target="#leave-modify"></a>
            <a (click)="detailLeave(leave.id)" class="fa fa-edit disabled" title="查看详情"
               [ngClass]="{'hidden': leave.top_leader_agree == null}"
               role="button" data-toggle="modal" data-target="#leave-detail"></a>
            <a (click)="signLeave(leave.id)" class="fa fa-check-circle" title="签到" role="button"
               [ngClass]="{ 'hidden':!leave.top_leader_agree || leave.signed_status}" style="margin-left: 10px"></a>
            <label class="label label-success" style="margin-left: 0px"
                   [ngClass]="{'hidden': !leave.top_leader_agree || !leave.signed_status}">已签到</label>
            <a (click)="revokeLeave(leave.id)" class="fa fa-bank" role="button" title="撤销"
               [ngClass]="{'hidden': !(leave.top_leader_agree == null)}" style="margin-left: 10px"></a>
          </td>
        </tr>

        </tbody>
      </table>
    </div>

    <div class="col-md-10 col-md-offset-0 table-responsive">
      <div class="col-md-6 col-md-offset-3 text-center">
        <div class="has-text-centered">
          <div class="spinner" [ngClass]="{ 'hidden': !isLoading }"></div>
          <pagination-controls (pageChange)="getPage($event)" id="server"></pagination-controls>
        </div>
      </div>
    </div>

    <!--<div class="col-md-10 col-md-offset-0 table-responsive">
      <div class="col-md-6 col-md-offset-3 text-center">
        <nav aria-label="Page navigation">
          <ul class="pagination pagination-lg">
            <li class="disabled">
              <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            <li class="active"><a href="#">1</a></li>
            <li><a href="#">2</a></li>
            <li><a href="#">3</a></li>
            <li><a href="#">4</a></li>
            <li><a href="#">5</a></li>
            <li>
              <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>-->
  </div>
</div>
